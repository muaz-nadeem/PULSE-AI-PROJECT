module.exports=[87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},53250,a=>{"use strict";var b=a.i(69240);function c(a){throw console.error("Supabase error:",a),Error(a.message||"An error occurred")}a.s(["aiAPI",0,{async getDailyPlan(a){let{data:{user:d}}=await b.supabase.auth.getUser();if(!d)throw Error("Not authenticated");let{data:e,error:f}=await b.supabase.from("ai_plans").select("*").eq("user_id",d.id).eq("plan_date",a).single();return f&&"PGRST116"!==f.code&&c(f),e||null},async acceptPlan(a){let{data:{user:d}}=await b.supabase.auth.getUser();if(!d)throw Error("Not authenticated");let{error:e}=await b.supabase.from("ai_plans").update({status:"accepted",accepted_at:new Date().toISOString()}).eq("id",a).eq("user_id",d.id);e&&c(e),await b.supabase.from("plan_feedback_events").insert({plan_id:a,user_id:d.id,event_type:"accepted"})},async rejectPlan(a){let{data:{user:d}}=await b.supabase.auth.getUser();if(!d)throw Error("Not authenticated");let{error:e}=await b.supabase.from("ai_plans").update({status:"rejected",rejected_at:new Date().toISOString()}).eq("id",a).eq("user_id",d.id);e&&c(e),await b.supabase.from("plan_feedback_events").insert({plan_id:a,user_id:d.id,event_type:"rejected"})},async updatePlanSchedule(a,d){let{data:{user:e}}=await b.supabase.auth.getUser();if(!e)throw Error("Not authenticated");let{data:f}=await b.supabase.from("ai_plans").select("schedule, edit_count").eq("id",a).eq("user_id",e.id).single(),{error:g}=await b.supabase.from("ai_plans").update({schedule:d,original_schedule:f?.schedule||null,status:"edited",edit_count:(f?.edit_count||0)+1,last_edited_at:new Date().toISOString()}).eq("id",a).eq("user_id",e.id);g&&c(g),await b.supabase.from("plan_feedback_events").insert({plan_id:a,user_id:e.id,event_type:"edited",event_data:{editCount:(f?.edit_count||0)+1}})},async logPlanTaskCompletion(a,c){let{data:{user:d}}=await b.supabase.auth.getUser();if(!d)throw Error("Not authenticated");await b.supabase.from("plan_feedback_events").insert({plan_id:a,user_id:d.id,event_type:"task_completed",event_data:{taskId:c}})},async getChatHistory(a=20){let{data:{user:d}}=await b.supabase.auth.getUser();if(!d)throw Error("Not authenticated");let{data:e,error:f}=await b.supabase.from("ai_chat_history").select("*").eq("user_id",d.id).order("created_at",{ascending:!1}).limit(a);return f&&c(f),e||[]},async saveChatMessage(a,d,e){let{data:{user:f}}=await b.supabase.auth.getUser();if(!f)throw Error("Not authenticated");let{error:g}=await b.supabase.from("ai_chat_history").insert({user_id:f.id,role:a,message:d,context_snapshot:e||null});g&&c(g)},async getUserAIProfile(){let{data:{user:a}}=await b.supabase.auth.getUser();if(!a)throw Error("Not authenticated");let{data:d,error:e}=await b.supabase.from("user_ai_profiles").select("*").eq("user_id",a.id).single();return e&&"PGRST116"!==e.code&&c(e),d||null},async getRecentAggregates(a=14){let{data:{user:d}}=await b.supabase.auth.getUser();if(!d)throw Error("Not authenticated");let e=new Date;e.setDate(e.getDate()-a);let f=e.toISOString().split("T")[0],{data:g,error:h}=await b.supabase.from("daily_aggregates").select("*").eq("user_id",d.id).gte("date",f).order("date",{ascending:!1});return h&&c(h),g||[]},async updateDailyRating(a,d){let{data:{user:e}}=await b.supabase.auth.getUser();if(!e)throw Error("Not authenticated");let f=Math.max(1,Math.min(10,d)),{error:g}=await b.supabase.from("daily_aggregates").upsert({user_id:e.id,date:a,daily_rating:f},{onConflict:"user_id,date"});g&&c(g)}},"authAPI",0,{async login(a,c){let{data:d,error:e}=await b.supabase.auth.signInWithPassword({email:a,password:c});if(e)throw Error(e.message||"Login failed");if(!d.session)throw Error("No session returned")},async register(a,c,d){let e=a.trim().toLowerCase(),{data:f,error:g}=await b.supabase.auth.signUp({email:e,password:d,options:{data:{name:c}}});if(g){let a=g.message.toLowerCase();if(422===g.status||a.includes("already registered")||a.includes("already exists")||a.includes("user already registered"))throw Error("This email is already registered. Please try logging in instead.");if(a.includes("invalid")&&a.includes("email")){if(a.includes("yawar@gmail.com")||a.includes("already"))throw Error("This email is already registered. Please try logging in instead.");throw Error("Please check your email format. Make sure it's a valid email address.")}throw Error(g.message||"Registration failed. Please try again.")}if(!f.user)throw Error("Failed to create user account. Please try again.");if(!f.session){let{data:a,error:c}=await b.supabase.auth.signInWithPassword({email:e,password:d});if(c||!a.session)throw console.error("Signup session error:",c),Error("Account created but failed to sign in. Please try logging in manually. If this persists, check that email confirmation is disabled in Supabase settings.")}await new Promise(a=>setTimeout(a,500));let{error:h}=await b.supabase.from("users").update({name:c}).eq("id",f.user.id);h&&console.error("Failed to update user name:",h)},logout(){b.supabase.auth.signOut()}},"focusSessionsAPI",0,{async getAll(){let{data:{user:a}}=await b.supabase.auth.getUser();if(!a)throw Error("Not authenticated");let{data:d,error:e}=await b.supabase.from("focus_sessions").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});return e&&c(e),d?.map(a=>({id:a.id,duration:a.duration,completed:a.completed,created_at:a.created_at,date:a.created_at}))||[]},async create(a){let{data:{user:d}}=await b.supabase.auth.getUser();if(!d)throw Error("Not authenticated");let{data:e,error:f}=await b.supabase.from("focus_sessions").insert({user_id:d.id,duration:a.duration,completed:a.completed}).select().single();return f&&c(f),{id:e.id,duration:e.duration,completed:e.completed,created_at:e.created_at,date:e.created_at}}},"tasksAPI",0,{async getAll(){let{data:{user:a}}=await b.supabase.auth.getUser();if(!a)throw Error("Not authenticated");let{data:d,error:e}=await b.supabase.from("tasks").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});return e&&c(e),d?.map(a=>({id:a.id,title:a.title,description:a.description||"",priority:a.priority,time_estimate:a.time_estimate,completed:a.completed,created_at:a.created_at,category:a.category,due_date:a.due_date,focus_mode:a.focus_mode}))||[]},async getById(a){let{data:{user:d}}=await b.supabase.auth.getUser();if(!d)throw Error("Not authenticated");let{data:e,error:f}=await b.supabase.from("tasks").select("*").eq("id",a).eq("user_id",d.id).single();return f&&c(f),{id:e.id,title:e.title,description:e.description||"",priority:e.priority,time_estimate:e.time_estimate,completed:e.completed,created_at:e.created_at,category:e.category,due_date:e.due_date,focus_mode:e.focus_mode}},async create(a){let{data:{user:d}}=await b.supabase.auth.getUser();if(!d)throw Error("Not authenticated");let{data:e,error:f}=await b.supabase.from("tasks").insert({user_id:d.id,title:a.title,description:a.description||"",priority:a.priority,time_estimate:a.time_estimate,category:a.category||null,due_date:a.due_date||null,focus_mode:a.focus_mode||!1}).select().single();return f&&c(f),{id:e.id,title:e.title,description:e.description||"",priority:e.priority,time_estimate:e.time_estimate,completed:e.completed,created_at:e.created_at,category:e.category,due_date:e.due_date,focus_mode:e.focus_mode}},async update(a,d){let{data:{user:e}}=await b.supabase.auth.getUser();if(!e)throw Error("Not authenticated");let f={};void 0!==d.title&&(f.title=d.title),void 0!==d.description&&(f.description=d.description),void 0!==d.priority&&(f.priority=d.priority),void 0!==d.time_estimate&&(f.time_estimate=d.time_estimate),void 0!==d.category&&(f.category=d.category),void 0!==d.due_date&&(f.due_date=d.due_date||null),void 0!==d.focus_mode&&(f.focus_mode=d.focus_mode),void 0!==d.completed&&(f.completed=d.completed);let{data:g,error:h}=await b.supabase.from("tasks").update(f).eq("id",a).eq("user_id",e.id).select().single();return h&&c(h),{id:g.id,title:g.title,description:g.description||"",priority:g.priority,time_estimate:g.time_estimate,completed:g.completed,created_at:g.created_at,category:g.category,due_date:g.due_date,focus_mode:g.focus_mode}},async delete(a){let{data:{user:d}}=await b.supabase.auth.getUser();if(!d)throw Error("Not authenticated");let{error:e}=await b.supabase.from("tasks").delete().eq("id",a).eq("user_id",d.id);e&&c(e)}},"usersAPI",0,{async getCurrentUser(){let{data:{session:a},error:d}=await b.supabase.auth.getSession();if(d||!a)throw Error("Not authenticated");let e=a.user,{data:f,error:g}=await b.supabase.from("users").select("email, name, onboarding_completed").eq("id",e.id).single();if(g&&"PGRST116"===g.code){let{error:a}=await b.supabase.from("users").insert({id:e.id,email:e.email||"",name:e.user_metadata?.name||null,onboarding_completed:!1});return a&&console.error("Failed to create user profile:",a),{email:e.email||"",name:e.user_metadata?.name||"",onboarding_completed:!1}}return g&&c(g),{email:f?.email||e.email||"",name:f?.name||"",onboarding_completed:f?.onboarding_completed||!1}},async updateCurrentUser(a){let{data:{session:d},error:e}=await b.supabase.auth.getSession();if(e||!d)throw Error("Not authenticated");let f=d.user,g={};void 0!==a.onboarding_completed&&(g.onboarding_completed=a.onboarding_completed),void 0!==a.name&&(g.name=a.name);let{error:h}=await b.supabase.from("users").update(g).eq("id",f.id);if(h)if("PGRST116"===h.code){let{error:d}=await b.supabase.from("users").insert({id:f.id,email:f.email||"",name:a.name||f.user_metadata?.name||null,onboarding_completed:a.onboarding_completed||!1});d&&c(d)}else c(h)}}])},47324,a=>{a.v(a=>Promise.resolve().then(()=>a(53250)))},96384,a=>{a.v(a=>Promise.resolve().then(()=>a(69240)))}];

//# sourceMappingURL=_ef387cec._.js.map