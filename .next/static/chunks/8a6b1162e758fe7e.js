(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54858,e=>{"use strict";var t=e.i(20755);function a(e){throw console.error("Supabase error:",e),Error(e.message||"An error occurred")}e.s(["authAPI",0,{async login(e,a){let{data:i,error:r}=await t.supabase.auth.signInWithPassword({email:e,password:a});if(r)throw Error(r.message||"Login failed");if(!i.session)throw Error("No session returned")},async register(e,a,i){let r=e.trim().toLowerCase(),{data:s,error:o}=await t.supabase.auth.signUp({email:r,password:i,options:{data:{name:a}}});if(o){let e=o.message.toLowerCase();if(422===o.status||e.includes("already registered")||e.includes("already exists")||e.includes("user already registered"))throw Error("This email is already registered. Please try logging in instead.");if(e.includes("invalid")&&e.includes("email")){if(e.includes("yawar@gmail.com")||e.includes("already"))throw Error("This email is already registered. Please try logging in instead.");throw Error("Please check your email format. Make sure it's a valid email address.")}throw Error(o.message||"Registration failed. Please try again.")}if(!s.user)throw Error("Failed to create user account. Please try again.");if(!s.session){let{data:e,error:a}=await t.supabase.auth.signInWithPassword({email:r,password:i});if(a||!e.session)throw console.error("Signup session error:",a),Error("Account created but failed to sign in. Please try logging in manually. If this persists, check that email confirmation is disabled in Supabase settings.")}await new Promise(e=>setTimeout(e,500));let{error:d}=await t.supabase.from("users").update({name:a}).eq("id",s.user.id);d&&console.error("Failed to update user name:",d)},logout(){t.supabase.auth.signOut()}},"focusSessionsAPI",0,{async getAll(){let{data:{user:e}}=await t.supabase.auth.getUser();if(!e)throw Error("Not authenticated");let{data:i,error:r}=await t.supabase.from("focus_sessions").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});return r&&a(r),i?.map(e=>({id:e.id,duration:e.duration,completed:e.completed,created_at:e.created_at,date:e.created_at}))||[]},async create(e){let{data:{user:i}}=await t.supabase.auth.getUser();if(!i)throw Error("Not authenticated");let{data:r,error:s}=await t.supabase.from("focus_sessions").insert({user_id:i.id,duration:e.duration,completed:e.completed}).select().single();return s&&a(s),{id:r.id,duration:r.duration,completed:r.completed,created_at:r.created_at,date:r.created_at}}},"tasksAPI",0,{async getAll(){let{data:{user:e}}=await t.supabase.auth.getUser();if(!e)throw Error("Not authenticated");let{data:i,error:r}=await t.supabase.from("tasks").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});return r&&a(r),i?.map(e=>({id:e.id,title:e.title,description:e.description||"",priority:e.priority,time_estimate:e.time_estimate,completed:e.completed,created_at:e.created_at,category:e.category,due_date:e.due_date,focus_mode:e.focus_mode}))||[]},async getById(e){let{data:{user:i}}=await t.supabase.auth.getUser();if(!i)throw Error("Not authenticated");let{data:r,error:s}=await t.supabase.from("tasks").select("*").eq("id",e).eq("user_id",i.id).single();return s&&a(s),{id:r.id,title:r.title,description:r.description||"",priority:r.priority,time_estimate:r.time_estimate,completed:r.completed,created_at:r.created_at,category:r.category,due_date:r.due_date,focus_mode:r.focus_mode}},async create(e){let{data:{user:i}}=await t.supabase.auth.getUser();if(!i)throw Error("Not authenticated");let{data:r,error:s}=await t.supabase.from("tasks").insert({user_id:i.id,title:e.title,description:e.description||"",priority:e.priority,time_estimate:e.time_estimate,category:e.category||null,due_date:e.due_date||null,focus_mode:e.focus_mode||!1}).select().single();return s&&a(s),{id:r.id,title:r.title,description:r.description||"",priority:r.priority,time_estimate:r.time_estimate,completed:r.completed,created_at:r.created_at,category:r.category,due_date:r.due_date,focus_mode:r.focus_mode}},async update(e,i){let{data:{user:r}}=await t.supabase.auth.getUser();if(!r)throw Error("Not authenticated");let s={};void 0!==i.title&&(s.title=i.title),void 0!==i.description&&(s.description=i.description),void 0!==i.priority&&(s.priority=i.priority),void 0!==i.time_estimate&&(s.time_estimate=i.time_estimate),void 0!==i.category&&(s.category=i.category),void 0!==i.due_date&&(s.due_date=i.due_date||null),void 0!==i.focus_mode&&(s.focus_mode=i.focus_mode),void 0!==i.completed&&(s.completed=i.completed);let{data:o,error:d}=await t.supabase.from("tasks").update(s).eq("id",e).eq("user_id",r.id).select().single();return d&&a(d),{id:o.id,title:o.title,description:o.description||"",priority:o.priority,time_estimate:o.time_estimate,completed:o.completed,created_at:o.created_at,category:o.category,due_date:o.due_date,focus_mode:o.focus_mode}},async delete(e){let{data:{user:i}}=await t.supabase.auth.getUser();if(!i)throw Error("Not authenticated");let{error:r}=await t.supabase.from("tasks").delete().eq("id",e).eq("user_id",i.id);r&&a(r)}},"usersAPI",0,{async getCurrentUser(){let{data:{session:e},error:i}=await t.supabase.auth.getSession();if(i||!e)throw Error("Not authenticated");let r=e.user,{data:s,error:o}=await t.supabase.from("users").select("email, name, onboarding_completed").eq("id",r.id).single();if(o&&"PGRST116"===o.code){let{error:e}=await t.supabase.from("users").insert({id:r.id,email:r.email||"",name:r.user_metadata?.name||null,onboarding_completed:!1});return e&&console.error("Failed to create user profile:",e),{email:r.email||"",name:r.user_metadata?.name||"",onboarding_completed:!1}}return o&&a(o),{email:s?.email||r.email||"",name:s?.name||"",onboarding_completed:s?.onboarding_completed||!1}},async updateCurrentUser(e){let{data:{session:i},error:r}=await t.supabase.auth.getSession();if(r||!i)throw Error("Not authenticated");let s=i.user,o={};void 0!==e.onboarding_completed&&(o.onboarding_completed=e.onboarding_completed),void 0!==e.name&&(o.name=e.name);let{error:d}=await t.supabase.from("users").update(o).eq("id",s.id);if(d)if("PGRST116"===d.code){let{error:i}=await t.supabase.from("users").insert({id:s.id,email:s.email||"",name:e.name||s.user_metadata?.name||null,onboarding_completed:e.onboarding_completed||!1});i&&a(i)}else a(d)}}])},11047,e=>{e.v(e=>Promise.resolve().then(()=>e(54858)))},90015,e=>{e.v(e=>Promise.resolve().then(()=>e(20755)))}]);